# Answer template for Crypto course, week 8


## Task 1

|                      | TLS 1.1                         | TLS 1.2                                                 | TLS 1.3                                                                                                                                                                                                                                     |
|-----------------------|-------------------------------|-------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|PRF uses     :         | MD5/SHA-1 combination         | Cipher suite specified hash                          |
|     IV-vector changes | Implicit to explicit          |-                                                     |-
| Cipher suites         | TLS_RSA_WITH_3DES_EDE_CBC_SHA | TLS_RSA_WITH_AES_128_CBC_SHA                         | Key agreement and authentication algorithms were separated from the cipher suites. Must support: TLS_AES_128_GCM_SHA256. Should also support: TLS_AES_256_GCM_SHA384                                                                                         |
| Key exchange          | Defined in cipher suites      | Defined in cipher suites                              | Zero round-trip time (0-RTT) mode was added for speed. Preshared keys can be used. Handshake is simpler and faster.  Must support key exchange with secp256r1 and should support  X25519 [RFC7748]. [GCM] and TLS_CHACHA20_POLY1305_SHA256 |
| support for authenticated encryption| No          | Yes          |Yes                                                         |
| Signatures            | Defined in cipher suites      | Defined in cipher suites                              | MUST support  rsa_pkcs1_sha256 (for certificates), rsa_pss_rsae_sha256 (for CertificateVerify and certificates), and ecdsa_secp256r1_sha256.                                                                                                         |
|Perfect forward security?| No                         | No                                                     | Yes! Also removed algorithms that don't comply   |
|Handshake changes      |                               |                                                       | All handshake messages after the ServerHello are now encrypted. Handshake is now simpler and faster.    |
|Signed elements use:| MD5/SHA-1 combination            | Single hash specified in element                                         |                                                                                                                                         |
|Other changes            |Protects now against padding manipulation| Tighter checking of EncryptedPreMasterSecret version numbers.                                                     | Elliptic curve algorithms are now in the base spec, and new       signature algorithms, such as EdDSA, are included                                                                                                                       |


## Task 2

### Task 2.1
Search strings were in a form of "tls 1.1" and "tlsv1.1" and produced 9+0, 21+2	and 18+3 results for tls 1.1, 1.2 and 1.3.

### Task 2.2
Most severe vulnerabilities for each are in the table below (tls 1.1, 1.2 and 1.3).

| Vulnerability and severity                                                                            |  CVE-2016-6884 <br>6.5                                                                                                                                                           |  CVE-2020-26197 <br>9.1                                                                                                                                                                                                                                                                                                 | CVE-2019-11873 <br>9.8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|-------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| How does the vulnerability work?                                                                      | TLS cipher suites with CBC mode in TLS 1.1 and 1.2 in MatrixSSL before 3.8.3 allow remote attackers to cause a denial of service (out-of-bounds read) via a crafted message. | 9.1. Dell PowerScale OneFS 8.1.0 - 9.1.0 contains an LDAP Provider inability to connect over TLSv1.2 vulnerability. It may make it easier to eavesdrop and decrypt such traffic for a malicious actor. Note: This does not affect clusters which are not relying on an LDAP server for the authentication provider. | wolfSSL 4.0.0 has a Buffer Overflow in DoPreSharedKeys in tls13.c when a current identity size is greater than a client identity size. An attacker sends a crafted hello client packet over the network to a TLSv1.3 wolfSSL server. The length fields of the packet: record length, client hello length, total extensions length, PSK extension length, total identity length, and identity length contain their maximum value which is 2^16. The identity data field of the PSK extension of the packet contains the attack data, to be stored in the undefined memory (RAM) of the server. The size of the data is about 65 kB. Possibly the attacker can perform a remote code execution attack. |
| What cryptographic primitive (if any) is affected?                                                    | CBC mode                                                                                                                                                                     |                      -                                                                                                                                                                                                                                                                                               |                  -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| At what level of abstraction does the vulnerability appear? | Implementation level                                                                                                                                                         | Imolementation level                                                                                                                                                                                                                                                                                                | Implementation level                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|  What types of applications does it impact?                                                           | MatrixSSL which is a tlls/SSL implementation                                                                                                                                 | Dell PowerScale OneFS is an NAS OS                                                                                                                                                                                                                                                                                                              | WolfSSL which is a TLS implementation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|  Can you find tools/code from the Internet that implement this attack?                                | No                                                                                                                                                                           | No                                                                                                                                                                                                                                                                                                                  |                                                           No                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Are there any news on this vulnerability being used in some data breach/attack?                       | No                                                                                                                                                                           | No                                                                                                                                                                                                                                                                                                                  | No, Vulnerability was found by security evaluator                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
<br>
### Task 2.3

Most recent vulnerabilities for tls 1.1, 1.2 and 1.3 are in the table below.

| Vulnerability and severity                                                                            | CVE-2017-8060 <br>5.9                                                                                                                                                                                                           |  CVE-2021-3449 <br>5.9                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | CVE-2021-3336 <br>8.1                                                                                                                                                                                                                                                                                                                                                                                                                     |
|-------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| How does the vulnerability work?                                                                      | Acceptance of invalid/self-signed TLS certificates in "Panda Mobile Security" 1.1 for iOS allows a man-in-the-middle and/or physically proximate attacker to silently intercept information sent during the login API call. | An OpenSSL TLS server may crash if sent a maliciously crafted renegotiation ClientHello message from a client. If a TLSv1.2 renegotiation ClientHello omits the signature_algorithms extension (where it was present in the initial ClientHello), but includes a signature_algorithms_cert extension then a NULL pointer dereference will result, leading to a crash and a denial of service attack. A server is only vulnerable if it has TLSv1.2 and renegotiation enabled (which is the default configuration).  | DoTls13CertificateVerify in tls13.c in wolfSSL before 4.7.0 does not cease processing for certain anomalous peer behavior (sending an ED22519, ED448, ECC, or RSA signature without the corresponding certificate). The client side is affected because man-in-the-middle attackers can impersonate TLS 1.3 servers. |
| What cryptographic primitive (if any) is affected?                                                    | -                                                                                                                                                                                                                |                 -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | -                                                                                                                                                                                                                                                                                                                                                                                                              |
| At what level of abstraction does the vulnerability appear? | Implementation                                                                                                                                                                                                              | implementation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Implementation                                                                                                                                                                                                                                                                                                                                                                                                                        |
|  What types of applications does it impact?                                                           | Panda mobile security, antivirus for iOS                                                                                                                                                                                    | OpenSSL TLS server                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | WolfSSL which is a TLS implementation                                                                                                                                                                                                                                                                                                                                                                                                 |
|  Can you find tools/code from the Internet that implement this attack?                                | No                                                                                                                                                                                                                          | No                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | No                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Are there any news on this vulnerability being used in some data breach/attack?                       | No                                                                                                                                                                                                                          | No, it was discovered by good gyus                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | No                                                                                                                                                                                                                                                                                                                                                                                                                                    |


## task 3
### task 3.1
Nmap scrip was used for retrieving ciphers and tls versions:
```console
nmap --script ssl-enum-ciphers -p 443 tlstest.rahtiapp.fi
```

Tls 1.0, 1.1 and 1.2 are supported. Supported ciphersuites are in the table below. Client preferences is used so server picks first suitable suit from clients list

 | TLS 1.0 & 1.1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | TLS 1.2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| TLS\_DHE\_RSA\_WITH\_3DES\_EDE\_CBC\_SHA (dh 1024) - D<br>TLS\_DHE\_RSA\_WITH\_AES\_128\_CBC\_SHA (dh 1024) - A<br>TLS\_DHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (dh 1024) - A<br><br>TLS\_DHE\_RSA\_WITH\_AES\_256\_CBC\_SHA (dh 1024) - A<br>TLS\_DHE\_RSA\_WITH\_AES\_256\_CBC\_SHA256 (dh 1024) - A<br><br>TLS\_DHE\_RSA\_WITH\_CAMELLIA\_128\_CBC\_SHA (dh 1024) - A<br>TLS\_DHE\_RSA\_WITH\_CAMELLIA\_256\_CBC\_SHA (dh 1024) - A<br>TLS\_DHE\_RSA\_WITH\_DES\_CBC\_SHA (dh 1024) - D<br>TLS\_DHE\_RSA\_WITH\_SEED\_CBC\_SHA (dh 1024) - A<br>TLS\_DH\_anon\_WITH\_3DES\_EDE\_CBC\_SHA - F<br>TLS\_DH\_anon\_WITH\_AES\_128\_CBC\_SHA - F<br>TLS\_DH\_anon\_WITH\_AES\_128\_CBC\_SHA256 - F<br><br>TLS\_DH\_anon\_WITH\_AES\_256\_CBC\_SHA - F<br>TLS\_DH\_anon\_WITH\_AES\_256\_CBC\_SHA256 - F<br><br>TLS\_DH\_anon\_WITH\_CAMELLIA\_128\_CBC\_SHA - F<br>TLS\_DH\_anon\_WITH\_CAMELLIA\_256\_CBC\_SHA - F<br>TLS\_DH\_anon\_WITH\_DES\_CBC\_SHA - F<br>TLS\_DH\_anon\_WITH\_RC4\_128\_MD5 - F<br>TLS\_DH\_anon\_WITH\_SEED\_CBC\_SHA - F<br>TLS\_ECDHE\_RSA\_WITH\_3DES\_EDE\_CBC\_SHA (secp256r1) - C<br>TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA (secp256r1) - A<br><br><br>TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA (secp256r1) - A<br><br><br>TLS\_ECDHE\_RSA\_WITH\_RC4\_128\_SHA (secp256r1) - C<br>TLS\_ECDH\_anon\_WITH\_3DES\_EDE\_CBC\_SHA - F<br>TLS\_ECDH\_anon\_WITH\_AES\_128\_CBC\_SHA - F<br>TLS\_ECDH\_anon\_WITH\_AES\_256\_CBC\_SHA - F<br>TLS\_ECDH\_anon\_WITH\_RC4\_128\_SHA - F<br>TLS\_RSA\_EXPORT\_WITH\_DES40\_CBC\_SHA - E<br>TLS\_RSA\_EXPORT\_WITH\_RC2\_CBC\_40\_MD5 - E<br>TLS\_RSA\_EXPORT\_WITH\_RC4\_40\_MD5 - E<br>TLS\_RSA\_WITH\_3DES\_EDE\_CBC\_SHA (rsa 4096) - C<br>TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA (rsa 4096) - A<br>TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (rsa 4096) - A<br><br>TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA (rsa 4096) - A<br>TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA256 (rsa 4096) - A<br><br>TLS\_RSA\_WITH\_CAMELLIA\_128\_CBC\_SHA (rsa 4096) - A<br>TLS\_RSA\_WITH\_CAMELLIA\_256\_CBC\_SHA (rsa 4096) - A<br>TLS\_RSA\_WITH\_DES\_CBC\_SHA (rsa 4096) - C<br>TLS\_RSA\_WITH\_IDEA\_CBC\_SHA (rsa 4096) - A<br>TLS\_RSA\_WITH\_RC4\_128\_MD5 (rsa 4096) - C<br>TLS\_RSA\_WITH\_RC4\_128\_SHA (rsa 4096) - C<br>TLS\_RSA\_WITH\_SEED\_CBC\_SHA (rsa 4096) - A | TLS\_DHE\_RSA\_WITH\_3DES\_EDE\_CBC\_SHA (dh 1024) - D<br>TLS\_DHE\_RSA\_WITH\_AES\_128\_CBC\_SHA (dh 1024) - A<br>TLS\_DHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (dh 1024) - A<br>TLS\_DHE\_RSA\_WITH\_AES\_128\_GCM\_SHA256 (dh 1024) - A<br>TLS\_DHE\_RSA\_WITH\_AES\_256\_CBC\_SHA (dh 1024) - A<br>TLS\_DHE\_RSA\_WITH\_AES\_256\_CBC\_SHA256 (dh 1024) - A<br>TLS\_DHE\_RSA\_WITH\_AES\_256\_GCM\_SHA384 (dh 1024) - A<br>TLS\_DHE\_RSA\_WITH\_CAMELLIA\_128\_CBC\_SHA (dh 1024) - A<br>TLS\_DHE\_RSA\_WITH\_CAMELLIA\_256\_CBC\_SHA (dh 1024) - A<br>TLS\_DHE\_RSA\_WITH\_DES\_CBC\_SHA (dh 1024) - D<br>TLS\_DHE\_RSA\_WITH\_SEED\_CBC\_SHA (dh 1024) - A<br>TLS\_DH\_anon\_WITH\_3DES\_EDE\_CBC\_SHA - F<br>TLS\_DH\_anon\_WITH\_AES\_128\_CBC\_SHA - F<br>TLS\_DH\_anon\_WITH\_AES\_128\_CBC\_SHA256 - F<br>TLS\_DH\_anon\_WITH\_AES\_128\_GCM\_SHA256 - F<br>TLS\_DH\_anon\_WITH\_AES\_256\_CBC\_SHA - F<br>TLS\_DH\_anon\_WITH\_AES\_256\_CBC\_SHA256 - F<br>TLS\_DH\_anon\_WITH\_AES\_256\_GCM\_SHA384 - F<br>TLS\_DH\_anon\_WITH\_CAMELLIA\_128\_CBC\_SHA - F<br>TLS\_DH\_anon\_WITH\_CAMELLIA\_256\_CBC\_SHA - F<br>TLS\_DH\_anon\_WITH\_DES\_CBC\_SHA - F<br>TLS\_DH\_anon\_WITH\_RC4\_128\_MD5 - F<br>TLS\_DH\_anon\_WITH\_SEED\_CBC\_SHA - F<br>TLS\_ECDHE\_RSA\_WITH\_3DES\_EDE\_CBC\_SHA (secp256r1) - C<br>TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA (secp256r1) - A<br>TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (secp256r1) - A<br>TLS\_ECDHE\_RSA\_WITH\_AES\_128\_GCM\_SHA256 (secp256r1) - A<br>TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA (secp256r1) - A<br>TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA384 (secp256r1) - A<br>TLS\_ECDHE\_RSA\_WITH\_AES\_256\_GCM\_SHA384 (secp256r1) - A<br>TLS\_ECDHE\_RSA\_WITH\_RC4\_128\_SHA (secp256r1) - C<br>TLS\_ECDH\_anon\_WITH\_3DES\_EDE\_CBC\_SHA - F<br>TLS\_ECDH\_anon\_WITH\_AES\_128\_CBC\_SHA - F<br>TLS\_ECDH\_anon\_WITH\_AES\_256\_CBC\_SHA - F<br>TLS\_ECDH\_anon\_WITH\_RC4\_128\_SHA - F<br>TLS\_RSA\_EXPORT\_WITH\_DES40\_CBC\_SHA - E<br>TLS\_RSA\_EXPORT\_WITH\_RC2\_CBC\_40\_MD5 - E<br>TLS\_RSA\_EXPORT\_WITH\_RC4\_40\_MD5 - E<br>TLS\_RSA\_WITH\_3DES\_EDE\_CBC\_SHA (rsa 4096) - C<br>TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA (rsa 4096) - A<br>TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (rsa 4096) - A<br>TLS\_RSA\_WITH\_AES\_128\_GCM\_SHA256 (rsa 4096) - A<br>TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA (rsa 4096) - A<br>TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA256 (rsa 4096) - A<br>TLS\_RSA\_WITH\_AES\_256\_GCM\_SHA384 (rsa 4096) - A<br>TLS\_RSA\_WITH\_CAMELLIA\_128\_CBC\_SHA (rsa 4096) - A<br>TLS\_RSA\_WITH\_CAMELLIA\_256\_CBC\_SHA (rsa 4096) - A<br>TLS\_RSA\_WITH\_DES\_CBC\_SHA (rsa 4096) - C<br>TLS\_RSA\_WITH\_IDEA\_CBC\_SHA (rsa 4096) - A<br>TLS\_RSA\_WITH\_RC4\_128\_MD5 (rsa 4096) - C<br>TLS\_RSA\_WITH\_RC4\_128\_SHA (rsa 4096) - C<br>TLS\_RSA\_WITH\_SEED\_CBC\_SHA (rsa 4096) - A |

### task 3.2
TLS 1.0 is lowest supported tls version.

### task 3.3
CVE-2016-2183 aka Sweet32 attack is possible at least. Also RC4 and MD5 are not secure: CVE-2004-2761 CVE-2015-2808

## Task 4
### Task 4.1
Didn't get the proxy working. I guess it should work initially? I'm not getting any responses from server to proxy or client.

Here's some code anyway:
```python
        self.raw_data = _socket.recv(5)
        self.length = int.from_bytes(self.raw_data[3:5], byteorder='big') #length of data after header


        if len(self.raw_data) < 5:
            self.logger.debug("Not enough data to be TLS record...")
            return

        self.text_content_type = self.tls_content_type[self.raw_data[0]] # data type

        if self.raw_data[0] not in self.tls_content_type: # if not tls 
            return

        self.raw_data += _socket.recv(16000) 

        if self.raw_data[0] == 22: #if tls handshake 
            handshake_type = self.raw_data[5]
            if handshake_type == 1: #if client hello
                self.tsl_v = self.raw_data[9:11]# Tsl version.  Could replace with b'\x03\x01' for tls1.0 ? 
                # do something to cipher suites ?
                # length of cipher suites data should be at self.raw_data[44:]
                # cipher suites should be in self.raw_data[45:45+length]    
```
Maybe I could just replace tls version from client hello to lowest supported by server? One option would be to drop connections until client requests some unsafe protocol. If that is how client behaves. This would propably be the way to go as tls version negotiation works this way in browsers at least.

If I remember correctly this server picks first cipher suite it supports from clients list. So I could just reorder the cipher suite data to get the suite I want. But this won't give me the servers supported cipher suites. Im not sure if I should use data from previous task to complete this or should I implement detecting server supported tls versions and cipher suites. Or should I just detect what client supports? 

To get servers supported cipher suites I could just send one cipher suite to server to know if it supports it. Then drop the connection so client sends another request which we can modify to test next cipher suite. Actually I don't need client for that. I could just check server protocols and suites independently of client after I get the initial client hello and modify it according to my check.

It really depends on the clients and servers behavior how the attack could be implemented. As I can't get proxy working I'm not able determine how client, server or proxy behaves.

### Task 4.2
BEAST vulnerability in TLS 1.0 could be used. Faulty padding and predictable iv:s in TLS 1.0 CBC mode allow attacker to retrieve secrets.

Proof of concept: https://github.com/mpgn/BEAST-PoC

### Task 4.3
Following explanation of tls 1.3 downgrade protection is from: https://blog.gypsyengineer.com/en/security/how-does-tls-1-3-protect-against-downgrade-attacks.html

"TLS 1.3 provides two measures to prevent downgrade attacks. First, it requires both client and server to send a Finished message which contains a MAC over all previous handshake messages, so that both client and server ensure that the negotiated parameters have not been modified in the middle by an attacker


Second, TLS 1.3 provides a downgrade protection mechanism which is embedded in the server’s random nonce in ServerHello message. If a TLS 1.3 server sees that it’s only possible to negotiate an older protocol version, then TLS 1.3 requires to set the last 8 bytes of their ServerHello.random field to one of the predefined values:

    If negotiating TLS 1.2, then the last 8 bytes have to be 44 4F 57 4E 47 52 44 01
    If negotiating TLS 1.1 or even older protocol versions, then the last 8 bytes have to be 44 4F 57 4E 47 52 44 00

Then, TLS 1.3 says that a client has to check that the last 8 bytes of received ServerHello.random are not equal to either of the values above, and if so, the connection has to be terminated."


I'd say that the ensuring that all hanshakes are not modified (first measure) allows for more comprehensive protection than just SCSV.

